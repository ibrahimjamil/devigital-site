(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{326:function(e,t,r){!function(e,t,r,s){"use strict";function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function n(e){for(var t,r=1;r<arguments.length;r++)t=null==arguments[r]?{}:arguments[r],r%2?a(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}));return e}function i(e){var t=e.srcList,s=e.imgPromise,a=void 0===s?c({decode:!0}):s,i=e.useSuspense,o=void 0===i||i,p=r.useState(!0)[1],g=u(l(t)),b=g.join("");if(d[b]||(d[b]={promise:h(g,a),cache:"pending",error:null}),d[b].promise.then((function(e){d[b]=n(n({},d[b]),{},{cache:"resolved",src:e}),o||p(!1)})).catch((function(e){d[b]=n(n({},d[b]),{},{cache:"rejected",error:e}),o||p(!1)})),"resolved"===d[b].cache)return{src:d[b].src,isLoading:!1,error:null};if("rejected"===d[b].cache){if(o)throw d[b].error;return{isLoading:!1,error:d[b].error,src:void 0}}if(o)throw d[b].promise;return{isLoading:!0,src:void 0,error:null}}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var o="default"in r?r.default:r;s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s;var c=function(e){var t=e.decode,r=e.crossOrigin,s=void 0===r?"":r;return function(e){return new Promise((function(r,a){var n=new Image;s&&(n.crossOrigin=s),n.onload=function(){(void 0===t||t)&&n.decode?n.decode().then(r).catch(a):r()},n.onerror=a,n.src=e}))}},u=function(e){return e.filter((function(e){return e}))},l=function(e){return Array.isArray(e)?e:[e]},d={},h=function(e,t){var r=!1;return new Promise((function(s,a){var n=function(e){return t(e).then((function(){r=!0,s(e)}))};e.reduce((function(e,t){return e.catch((function(){if(!r)return n(t)}))}),n(e.shift())).catch(a)}))},p=function(e){return e};e.Img=function(e){var r=e.decode,s=e.src,a=void 0===s?[]:s,n=e.loader,u=void 0===n?null:n,l=e.unloader,d=void 0===l?null:l,h=e.container,g=void 0===h?p:h,b=e.loaderContainer,j=void 0===b?p:b,f=e.unloaderContainer,O=void 0===f?p:f,m=e.imgPromise,v=e.crossorigin,x=e.useSuspense,y=void 0!==x&&x,w=t(e,["decode","src","loader","unloader","container","loaderContainer","unloaderContainer","imgPromise","crossorigin","useSuspense"]),S=i({srcList:a,imgPromise:m=m||c({decode:!(void 0!==r)||r,crossOrigin:v}),useSuspense:y}),R=S.src,C=S.isLoading;return R?g(o.createElement("img",Object.assign({src:R},w))):!y&&C?j(u):!y&&d?O(d):null},e.useImage=i,Object.defineProperty(e,"__esModule",{value:!0})}(t,r(234),r(0),r(105))},342:function(e,t,r){"use strict";r.r(t);var s=r(7),a=r(5),n=r(17),i=r(1),o=r(0),c=r(326),u=r(47),l=r.n(u),d=r(88),h=r(9),p=r(87),g=r(30),b=r(212),j=r(8),f=r(22),O=r(2),m=r(320),v=r.n(m);class x extends o.Component{static getDerivedStateFromProps(e,t){const{savedValue:r,value:s}=e,{changeStatus:a}=t;switch(a){case"removed":if(null===r&&null===s)return{originalFile:r,changeStatus:"empty"};break;case"updated":if(v()(r,s))return{originalFile:r,changeStatus:"stored"}}return null}constructor(e){super(e),Object(n.a)(this,"onCancel",()=>{const{originalFile:e}=this.state;this.props.onChange(e),this.inputRef&&(this.inputRef.value=""),this.setState({changeStatus:e?"stored":"empty",dataURI:null,errorMessage:null})}),Object(n.a)(this,"onRemove",()=>{this.setState({changeStatus:"removed",errorMessage:null}),this.props.onChange(null)}),Object(n.a)(this,"onChange",({target:{validity:e,files:[t]}})=>{if(!t)return;const{errorMessage:r,onChange:s}=this.props,a={changeStatus:"updated"};e.valid?(t.type.includes("image")?(this.getDataURI(t),a.oldImagePath=this.getImagePath()):this.state.dataURI&&this.setState({dataURI:null,errorMessage:null}),s(t),this.setState(a)):this.setState({errorMessage:r({type:"save"})})}),Object(n.a)(this,"openFileBrowser",()=>{this.inputRef&&this.inputRef.click()}),Object(n.a)(this,"getFile",()=>{const{value:e}=this.props,{changeStatus:t,originalFile:r}=this.state,s="removed"===t?r:e;return{file:s,type:s&&s.__typename?"server":"client"}}),Object(n.a)(this,"getDataURI",e=>{const{errorMessage:t}=this.props,r=new FileReader;r.readAsDataURL(e),r.onloadstart=()=>{this.setState({isLoading:!0})},r.onerror=e=>{console.error("Error with Cloudinary preview",e),this.setState({errorMessage:t({type:"preview"})})},r.onloadend=e=>{this.setState({isLoading:!1,dataURI:e.target.result})}}),Object(n.a)(this,"getImagePath",()=>{const{dataURI:e}=this.state,{file:t}=this.getFile();return t&&t.mimetype&&t.mimetype.includes("image")?t.publicUrl:e}),Object(n.a)(this,"getInputRef",e=>{this.inputRef=e}),Object(n.a)(this,"renderUploadButton",()=>{const{uploadButtonLabel:e,isDisabled:t}=this.props,{changeStatus:r,isLoading:s}=this.state;return Object(i.jsx)(j.c,{onClick:this.openFileBrowser,isLoading:s,variant:"ghost",isDisabled:t},e({status:r}))}),Object(n.a)(this,"renderCancelButton",()=>{const{cancelButtonLabel:e,isDisabled:t}=this.props,{changeStatus:r}=this.state;let s="warning",a=this.onRemove;switch(r){case"removed":s="primary",a=this.onCancel;break;case"updated":a=this.onCancel}return Object(i.jsx)(j.a,{onClick:a,variant:"subtle",appearance:s,isDisabled:t},e({status:r}))});const{value:t}=e,r=t?"stored":"empty";this.state={originalFile:t,changeStatus:r,dataURI:null,errorMessage:null,isLoading:!1,oldImagePath:null}}render(){const{autoFocus:e,field:t,statusMessage:r,errors:s,isDisabled:a}=this.props,{changeStatus:n,errorMessage:o}=this.state,{file:c}=this.getFile(),u=this.getImagePath(),l=["removed","updated"].includes(n),h="ks-input-"+t.path;return Object(i.jsx)(d.a,null,Object(i.jsx)(d.d,{htmlFor:h,field:t,errors:s}),Object(i.jsx)(d.b,{text:t.adminDoc}),Object(i.jsx)(d.c,null,c?Object(i.jsx)(y,null,u&&Object(i.jsx)(L,{src:u,alt:t.path}),Object(i.jsx)(w,null,Object(i.jsx)(f.d,{style:{marginBottom:O.d}},this.renderUploadButton(),this.renderCancelButton()),o?Object(i.jsx)(R,null,o):Object(i.jsx)(f.d,{isInline:!0,growIndexes:[0]},Object(i.jsx)(S,{href:c.publicUrl},c.filename||c.name),l?Object(i.jsx)(P,{status:n},r({status:n})):null))):this.renderUploadButton(),Object(i.jsx)(p.b,{autoComplete:"off",autoFocus:e,id:h,ref:this.getInputRef,name:t.path,onChange:this.onChange,type:"file",disabled:a})))}}Object(n.a)(x,"propTypes",{cancelButtonLabel:l.a.func.isRequired,disabled:l.a.bool,errorMessage:l.a.func.isRequired,field:l.a.object,onChange:l.a.func.isRequired,statusMessage:l.a.func.isRequired,uploadButtonLabel:l.a.func.isRequired}),Object(n.a)(x,"defaultProps",{cancelButtonLabel:function({status:e}){switch(e){case"stored":return"Remove File";case"removed":return"Undo Remove";case"updated":default:return"Cancel"}},errorMessage:function({type:e}){switch(e){case"save":return"Something went wrong, please reload and try again.";case"preview":return"Something went wrong, please try again."}},statusMessage:function({status:e}){switch(e){case"removed":return"save to remove";case"updated":return"save to upload"}},uploadButtonLabel:function({status:e}){return"empty"===e?"Upload File":"Change File"}});const y=e=>Object(i.jsx)("div",Object(a.a)({css:{alignItems:"flex-start",display:"flex"}},e)),w=e=>Object(i.jsx)("div",Object(a.a)({css:{flex:1,minWidth:0}},e)),S=e=>Object(i.jsx)(b.a,Object(a.a)({crop:"right"},e)),R=e=>{let{children:t}=e,r=Object(s.a)(e,["children"]);return Object(i.jsx)(b.a,Object(a.a)({style:{backgroundColor:O.b.R.L80,borderColor:"transparent",color:O.b.R.D20,display:"inline-flex"}},r),Object(i.jsx)(h.a,{css:{marginRight:O.d}}),t)},C={default:"primary",removed:"danger",updated:"create"},P=e=>{let{status:t="default"}=e,r=Object(s.a)(e,["status"]);const n=C[t];return Object(i.jsx)(b.a,Object(a.a)({appearance:n},r))},I=({src:e,alt:t})=>{const{src:r}=Object(c.useImage)({srcList:e});return Object(i.jsx)("img",{css:{display:"block",height:"auto",maxWidth:"100%"},src:r,alt:t})},L=e=>Object(i.jsx)("div",{css:{backgroundColor:"white",borderRadius:O.a,border:"1px solid "+O.b.N20,flexShrink:0,marginRight:O.d,padding:"4px",position:"relative",textAlign:"center",width:130}},Object(i.jsx)(F,null,Object(i.jsx)(o.Suspense,{fallback:Object(i.jsx)(g.a,null)},Object(i.jsx)(I,e))));class F extends o.Component{constructor(...e){super(...e),Object(n.a)(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?Object(i.jsx)("div",{css:{padding:"4px 0",color:O.b.N40}},Object(i.jsx)("div",null,Object(i.jsx)(h.g,null)),Object(i.jsx)("span",{css:{fontSize:"0.9em"}},"Could not load image")):this.props.children}}t.default=x}}]);